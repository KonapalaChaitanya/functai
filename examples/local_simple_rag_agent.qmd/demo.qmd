```{python}
from attachments import Attachments, set_verbose
set_verbose(False)

from ovllm import llm, llmtogpu
from functai import ai
```

from attachments import Attachments, set_verbose
set_verbose(False)

from ovllm import llm, llmtogpu
from functai import ai

llmtogpu("Qwen/Qwen3-30B-A3B-Instruct-2507-FP8",
        max_tokens=500, 
vllm_args={"tensor_parallel_size": 2, "gpu_memory_utilization": 0.80,
"max_model_len": 12000})

def website_retriever(url):
    "Retrieves text content of a url"
    return Attachments(url + "[images: false]").text

@ai(lm=llm, module="cot")
def doublecheck(fact: str, grounding: str) -> bool:
    """Provided a fact and the grounding (a short snippet) 
    where that fact originates this function returns True 
    is the fact is correctly extracted
    """
    ...

@ai(lm=llm, tools=[website_retriever, doublecheck])
def rag(question) -> str:
    ...

rag("What castle David Gregory inherited? Look there:" +
    "Always call doubleck tool at least once!" +
    "https://en.wikipedia.org/wiki/David_Gregory_(physician)")